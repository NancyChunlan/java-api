package net.ossindex.common;

import java.util.Date;
import java.util.Iterator;
import java.util.List;

/** Represents a vulnerability from OSS Index
 * 
 * @author Ken Duck
 *
 */
public class VulnerabilityDescriptor {
	private long id;
	private String title;
	private String description;
	private List<String> versions;
	private List<String> references;
	private long published;
	private long updated;
	
	public long getId() {
		return id;
	}
	
	public String getTitle() {
		return title;
	}

	public String getDescription() {
		return description;
	}

	public List<String> getVersions() {
		return versions;
	}

	public List<String> getReferences() {
		return references;
	}

	public long getPublished() {
		return published;
	}
	
	public Date getPublishedDate() {
		return new Date(published);
	}

	public long getUpdated() {
		return updated;
	}
	
	public Date getUpdatedDate() {
		return new Date(updated);
	}
	
	/*
	 * (non-Javadoc)
	 * @see java.lang.Object#toString()
	 */
	@Override
	public String toString() {
		StringBuilder sb = new StringBuilder();
		sb.append("[").append(id).append("] ").append(title).append(" (");
		if (versions != null) {
			for (Iterator<String> it = versions.iterator(); it.hasNext();) {
				String version = it.next();
				sb.append(version);
				if (it.hasNext()) {
					sb.append(" || ");
				}
			}
		}
		sb.append(")");
		return sb.toString();
	}
}
